<!-- ====== CONTENT: chỉ phần giữa ====== -->
<%- include('partials/header') %>
<link rel="stylesheet" href="/assets/css/event_review.css">
<link rel="stylesheet" href="https://cdnjs.cloudflare.com/ajax/libs/font-awesome/6.5.0/css/all.min.css">
<div class="GI-NH-GI">
    <!-- Hero -->
    <div class="banner-section">
        <img class="banner" src="/assets/images/banner.png" alt="Banner" />
        <div class="banner-overlay"></div>
        <div class="banner-title">SỰ KIỆN TẠI DUE</div>
        <p class="banner-subtitle">Khám phá và đăng ký tham gia các workshop, seminar và hội thảo chuyên môn</p>
    </div>

    <!-- Quay lại -->
    <a href="/my_event" class="quay-l-i">
        <i class="fa-solid fa-arrow-left"></i> Quay lại
    </a>

    <!-- Cột trái: ảnh + mô tả -->
    <img class="image-2" src="/assets/images/event_1.png" alt="Ảnh sự kiện" />
    <div class="frame-6">
        <div class="rectangle-4"></div>
        <p class="text-wrapper-14">Khoa Thống kê - Tin học</p>
    </div>
    <p class="text-wrapper-15">Lập kế hoạch kinh doanh trên 1 trang giấy</p>
    <p class="h-i-th-o-v-xu-h-ng-c">
        Hội thảo về xu hướng công nghệ tài chính và sự chuyển đổi số trong ngành nhằm mang đến cái nhìn tổng quan
        về sự thay đổi mạnh mẽ của công nghệ trong lĩnh vực tài chính – ngân hàng, đồng thời chia sẻ cơ hội, thách thức
        và giải pháp ứng dụng công nghệ trong quản trị, kinh doanh và khởi nghiệp.<br />
        Sự kiện quy tụ các chuyên gia, giảng viên và sinh viên, cùng thảo luận về những xu hướng FinTech nổi bật như
        thanh toán không tiền mặt, ngân hàng số, blockchain và trí tuệ nhân tạo trong tài chính. Đây là cơ hội kết nối,
        học hỏi và cập nhật kiến thức về chuyển đổi số trong kỷ nguyên công nghệ 4.0. Hội thảo về xu hướng công nghệ tài chính và sự chuyển đổi số trong ngành nhằm mang đến cái nhìn tổng quan
        về sự thay đổi mạnh mẽ của công nghệ trong lĩnh vực tài chính – ngân hàng, đồng thời chia sẻ cơ hội, thách thức. Đây là cơ hội kết nối, 
        học hỏi và cập nhật kiến thức thực tiễn về chuyển đổi số trong kỷ nguyên công nghệ 4.0. Đây là cơ hội kết nối,
        học hỏi và cập nhật kiến thức về chuyển đổi số trong kỷ nguyên công nghệ 4.0. Hội thảo về xu hướng công nghệ tài chính và sự chuyển đổi số trong ngành nhằm mang đến cái nhìn tổng quan
        về sự thay đổi mạnh mẽ của công nghệ trong lĩnh vực tài chính – ngân hàng, đồng thời chia sẻ cơ hội, thách thức. Đây là cơ hội kết nối, 
        học hỏi và cập nhật kiến thức thực tiễn về chuyển đổi số trong kỷ nguyên công nghệ 4.0. Đây là cơ hội kết nối,
        học hỏi và cập nhật kiến thức về chuyển đổi số trong kỷ nguyên công nghệ 4.0. Hội thảo về xu hướng công nghệ tài chính và sự chuyển đổi số trong ngành nhằm mang đến cái nhìn tổng quan
        về sự thay đổi mạnh mẽ của công nghệ trong lĩnh vực tài chính – ngân hàng, đồng thời chia sẻ cơ hội, thách thức. Đây là cơ hội kết nối, 
        học hỏi và cập nhật kiến thức thực tiễn về chuyển đổi số trong kỷ nguyên công nghệ 4.0. 
    </p>

    <!-- Cột phải: thông tin chi tiết -->
    <div class="frame-7">
        <div class="text-wrapper-16">Thông tin chi tiết</div>
        <p class="text-wrapper-17">Chủ nhật, 9 tháng 11, 2025</p>
        <div class="text-wrapper-18">Địa điểm</div>
        <div class="text-wrapper-19">Số lượng</div>
        <div class="text-wrapper-20">Thành phần tham dự</div>
        <div class="text-wrapper-21">Hội trường A</div>
        <p class="element-ng-i-ng-k-c-n">
            <span class="span">31/50 người đã đăng ký </span> <span class="text-wrapper-22">(Còn 19 chỗ)</span>
        </p>
        <div class="text-wrapper-23">Doanh nhân Phạm Nhật Vượng, Diễn giả Nguyễn Thanh Hiền</div>
        <div class="text-wrapper-24">10:00 - 12:30</div>

        <div class="lets-icons-date">
            <i class="fa-solid fa-clock"></i>
        </div>
        <div class="tdesign-location">
            <i class="fa-solid fa-location-dot"></i>
        </div>
        <div class="ion-people-outline">
            <i class="fa-solid fa-users"></i>
        </div>
    </div>

    <!-- Badge loại & trạng thái -->
    <div class="frame-8">
        <div class="rectangle-5"></div>
        <div class="text-wrapper-25">Workshop</div>
    </div>
    <div class="frame-9">
        <div class="text-wrapper-26">ĐÃ HOÀN THÀNH</div>
    </div>
<div class="background-border">
    <p class="heading-di-n-gi">Đánh giá sự kiện này</p>
    <div class="text-wrapper-31">Đánh giá của bạn</div>
    <div class="text-wrapper-32">Nhận xét</div>
    <p class="text-wrapper-33">
      Chúng tôi rất vinh hạnh nhận được đánh giá chân thành từ bạn từ ngày càng tốt hơn!
    </p>

    <!-- TRẠNG THÁI 1 -->
    <div id="state1">
      <div class="rectangle-6">
        <textarea class="review-input" id="reviewInput" placeholder="Viết đánh giá của bạn..."></textarea>
      </div>
      <div class="star-rating" id="starRating">
        <i class="star fas fa-star" data-value="1"></i>
        <i class="star fas fa-star" data-value="2"></i>
        <i class="star fas fa-star" data-value="3"></i>
        <i class="star fas fa-star" data-value="4"></i>
        <i class="star fas fa-star" data-value="5"></i>
      </div>
      <div class="group-7" id="sendBtn">
        <div class="rectangle-7"></div>
        <div class="text-wrapper-34">Gửi đánh giá</div>
      </div>
    </div>

    <!-- TRẠNG THÁI 2 -->
    <div id="state2" class="hidden">
        <div class="rectangle-6">
    <div class="review-box">
        <div class="review-input" id="reviewText"></div>
    </div>
      <div class="review-stars" id="reviewStars">
      <i class="star fas fa-star"></i>
      <i class="star fas fa-star"></i>
      <i class="star fas fa-star"></i>
      <i class="star fas fa-star"></i>
      <i class="star fas fa-star"></i>
    </div>
      <div class="action-buttons">
        <button class="btn-edit" id="editBtn">Sửa đánh giá</button>
        <button class="btn-delete" id="deleteBtn">Xóa</button>
      </div>
    </div>
  </div>
</div>
</div>

<!-- TOAST -->
<div class="success-toast" id="successToast">
  <svg width="16" height="16" viewBox="0 0 16 16" fill="none" xmlns="http://www.w3.org/2000/svg" style="margin-right: 8px;">
    <path d="M13.3337 4.66675L6.00033 12.0001L2.66699 8.66675" stroke="#28a745" stroke-width="2" stroke-linecap="round" stroke-linejoin="round"/>
  </svg>
  Đã gửi đánh giá về sự kiện
</div>

<!-- MODAL -->
<div class="modal-overlay" id="deleteModal">
  <div class="modal">
    <div class="modal-header">
      <span>Xác nhận</span>
      <button class="modal-close" id="closeModal">×</button>
    </div>
    <div class="modal-body">Bạn có chắc chắn muốn xóa đánh giá này?</div>
    <div class="modal-footer">
      <button class="modal-btn modal-btn-cancel" id="cancelDelete">Hủy</button>
      <button class="modal-btn modal-btn-delete" id="confirmDelete">Xóa</button>
    </div>
  </div>
</div>

<script>
  document.addEventListener('DOMContentLoaded', () => {
    const state1 = document.getElementById('state1');
    const state2 = document.getElementById('state2');
    const sendBtn = document.getElementById('sendBtn');
    const editBtn = document.getElementById('editBtn');
    const deleteBtn = document.getElementById('deleteBtn');
    const reviewInput = document.getElementById('reviewInput');
    const reviewDisplay = document.getElementById('reviewDisplay');
    const reviewRating = document.getElementById('reviewDisplay');
    const starRating = document.getElementById('starRating');
    const modal = document.getElementById('deleteModal');
    const toast = document.getElementById('successToast');

    let currentRating = 0;

    // Load
    const saved = localStorage.getItem('event_review');
if (saved) {
  const data = JSON.parse(saved);
  document.getElementById('reviewText').textContent = data.text;
  updateDisplayStars(data.rating);
  state1.classList.add('hidden');
  state2.classList.remove('hidden');
}

    // Sao
    starRating.addEventListener('click', (e) => {
      if (e.target.classList.contains('star')) {
        currentRating = e.target.dataset.value;
        updateStars();
        checkCanSend();
      }
    });

    function updateStars() {
      document.querySelectorAll('#starRating .star').forEach((star, i) => {
        star.classList.toggle('filled', i < currentRating);
      });
    }

    function updateDisplayStars(rating) {
    const stars = document.querySelectorAll('#reviewStars .star');
    stars.forEach((star, i) => {
        star.classList.toggle('filled', i < rating);
    });
    }

    function checkCanSend() {
      const canSend = reviewInput.value.trim().length > 0 && currentRating > 0;
      sendBtn.classList.toggle('active', canSend);
    }
    reviewInput.addEventListener('input', checkCanSend);

    // Gửi
sendBtn.addEventListener('click', () => {
  if (!sendBtn.classList.contains('active')) return;
  const text = reviewInput.value.trim();
  document.getElementById('reviewText').textContent = text;
  updateDisplayStars(currentRating);
  localStorage.setItem('event_review', JSON.stringify({ text, rating: currentRating }));
  state1.classList.add('hidden');
  state2.classList.remove('hidden');
  document.getElementById('successToast').classList.add('show');
  setTimeout(() => document.getElementById('successToast').classList.remove('show'), 2000);
});

    // Sửa
    editBtn.addEventListener('click', () => {
      const saved = JSON.parse(localStorage.getItem('event_review'));
      reviewInput.value = saved.text;
      currentRating = saved.rating;
      updateStars();
      checkCanSend();
      state2.classList.add('hidden');
      state1.classList.remove('hidden');
    });

    // Xóa
    deleteBtn.addEventListener('click', () => modal.style.display = 'flex');
    const closeModal = () => modal.style.display = 'none';
    document.getElementById('closeModal').onclick = closeModal;
    document.getElementById('cancelDelete').onclick = closeModal;
    modal.onclick = (e) => { if (e.target === modal) closeModal(); };

    document.getElementById('confirmDelete').onclick = () => {
      localStorage.removeItem('event_review');
      reviewInput.value = ''; currentRating = 0; updateStars(); checkCanSend();
      closeModal();
      state2.classList.add('hidden');
      state1.classList.remove('hidden');
    };
  });
</script>
<%- include('partials/footer') %>